<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <canvas id="canvas" width="500" height="500" style="background:black;"><canvas>
      <style>
        body {
          background: gray;
        }
      </style>
      <script>
        function captureMouse(mouse = { x: 0, y: 0 }) {
          canvas.addEventListener('mousemove', function (e) {
            mouse.x = e.pageX - canvas.offsetLeft
            mouse.y = e.pageY - canvas.offsetTop
          })
          return mouse
        }
        class Spring {
          constructor(initLength) {
            this.x = 0
            this.y = 0
            this.angle = 0
            this.initLength = initLength
          }
          draw(context) {
            context.save()
            context.translate(this.x, this.y)
            context.rotate(this.angle)
            context.strokeStyle = 'white'
            context.beginPath()
            context.moveTo(0, 0)
            var n = 16
            var h = 25
            var d = (this.initLength - 2 * h) / n
            context.lineTo(h, 0)
            for (var i = 0; i < n; i++) {
              var dir = i % 2 == 0 ? 1 : -1
              context.quadraticCurveTo(h + d * (i + 0.5), 20 * dir, h + d * (i + 1), 0)
            }
            context.lineTo(this.initLength, 0)
            context.stroke()
            context.restore()
          }
        }
        class Ball {
          constructor() {
            this.x = 0
            this.y = 0
            this.radius = 20
            this.angle = 0
          }
          draw(context) {
            context.save()
            context.translate(this.x, this.y)
            context.rotate(this.angle)
            context.fillStyle = 'red'
            context.beginPath()
            context.arc(0, 0, this.radius, 0, Math.PI * 2)
            context.fill()
            context.restore()
          }
          isMouseIn(mouse) {
            var dx = mouse.x - this.x
            var dy = mouse.y - this.y
            return dx * dx + dy * dy <= this.radius * this.radius
          }
        }

        var context = canvas.getContext('2d')
        var initLength = 150
        var amplitude = 70
        var spring = new Spring(initLength)
        spring.x = canvas.width / 2
        spring.y = canvas.height / 2
        var ball = new Ball()
        ball.x = canvas.width / 2 + initLength
        ball.y = canvas.height / 2

        var mouse = captureMouse({ x: canvas.width / 2, y: canvas.height / 2 })
        var k = 0.03
        var friction = 0.99
        var vx = 0
        var vy = 0
        var gravity = 1

          ; (function drawFrame() {
            window.requestAnimationFrame(drawFrame)
            context.clearRect(0, 0, canvas.width, canvas.height)
            spring.x = mouse.x
            spring.y = mouse.y
            var dx = ball.x - spring.x
            var dy = ball.y - spring.y
            var x = Math.sqrt(dx * dx + dy * dy) - initLength
            var f = -k * x
            var angle = Math.atan2(dy, dx)
            var fx = f * Math.cos(angle)
            var fy = f * Math.sin(angle)
            vx += fx
            vy += fy
            vy += gravity
            vx *= friction
            vy *= friction
            ball.x += vx
            ball.y += vy
            var dx = ball.x - spring.x
            var dy = ball.y - spring.y
            var angle = Math.atan2(dy, dx)
            var length = Math.sqrt(dx * dx + dy * dy)
            spring.initLength = length
            spring.angle = angle
            spring.draw(context)
            ball.draw(context)
          })()
      </script>
</body>
</html>