<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      canvas {
        border: 1px solid #999;
        background: #999;
      }
    </style>
  </head>

  <body>
    <canvas id="canvas" width="600" height="600"></canvas>
  </body>
  <script>
    const log = console.log.bind(console);
    const canvas = document.querySelector("#canvas");
    const context = canvas.getContext("2d");

    colors = [
      "#f44336",
      "#e91e63",
      "#9c27b0",
      "#673ab7",
      "#3f51b5",
      "#2196f3",
      "#03a9f4",
      "#00bcd4",
      "#009688",
      "#4CAF50",
      "#8BC34A",
      "#CDDC39",
      "#FFEB3B",
      "#FFC107",
      "#FF9800",
      "#FF5722",
    ];

    class Ball {
      constructor(x, y, radius, color) {
        this.x = x;
        this.y = y;
        this.vx = 3;
        this.vy = 0;
        this.radius = radius * Math.random();
        this.angle = 0;
        this.color = color || "#fff";
      }

      draw(ctx) {
        ctx.save();
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, Math.PI * 2, false);
        ctx.closePath();
        ctx.fill();
        ctx.restore();
      }

      move() {
        this.x += this.vx;
        this.y += this.vy;
      }

      update(context) {
        // this.move();
        this.draw(context);
      }
    }

    class Shape {
      constructor(text) {
        this.x = 0;
        this.y = 0;
        this.size = 110;
        this.text = text;
        this.textZone = [];
      }

      draw(ctx) {
        ctx.save();
        ctx.textAlign = "center";
        ctx.font = this.size + "px arial";
        ctx.fillText("Hello world", canvas.width / 2, canvas.height / 2);
        ctx.restore();

        let imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);

        let buffer32 = new Uint32Array(imgData.data.buffer);
        log(buffer32.length);
        for (let i = 0; i < canvas.width; i++) {
          for (let j = 0; j < canvas.height; j++) {
            if (buffer32[canvas.width * j + i]) {
              let particle = new Ball(i, j, 2);
              this.textZone.push(particle);
            }
          }
        }
      }

      getValue() {}
    }

    let shape = new Shape("店宝宝");
    shape.draw(context);
    log(shape.textZone[0]);
    for (var i = 0; i < shape.textZone.length; i++) {
      shape.textZone[i].draw(context);
    }

    // const drawFrame = function () {
    //   window.requestAnimationFrame(drawFrame);
    //   context.clearRect(0, 0, canvas.width, canvas.height);
    //   for (var i = 0; i < shape.textZone.length; i++) {
    //     shape.textZone[i].update(context);
    //   }
    // };

    // drawFrame();
  </script>
</html>
